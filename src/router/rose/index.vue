<template lang="html">
  <div class="rose">
    <button @click="messageBox">{{ new Date() | dateFormate('YYMMDD') }}</button>

    <canvas id="rose-canvas"></canvas>

    <div class="heart">
      <p>I&emsp;ðŸ’—&emsp;U</p>
    </div>

    <pre>
      <span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>66<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>666<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>66<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>6666<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>666<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>666<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>6666<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>
      <span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>6<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>6<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>6<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>6666<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>66<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>66<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>66<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>6666<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>
      <span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>66<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>66<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>6666<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>6<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>6666<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>6<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>6666<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>
      <span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>6666<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>66666<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>666<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>6666<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>6<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>6666<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>
      <span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>666666<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>66666666<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>6666<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>6666<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>6<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>6666<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>
      <span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>66666666<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>6666666666<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>66666<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>66<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>66<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>6666<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>
      <span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>666666666<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>66666666666<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>666666<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>6666<span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span><span style="background: #ff079e; color: #fff;">9</span>6
    </pre>
  </div>
</template>

<style lang="scss" scoped>
.rose {
  width: 400px;
  margin: 0 auto;

  .heart {
    width: 200px;
    height: 200px;
    margin: 100px auto;
    background: red;
    transform: rotate(45deg);
    animation-duration: 3s;
    animation-name: heart;
    animation-fill-mode: forwards;

    &:before{
      content: "";
      width: 200px;
      height: 200px;
      background: red;
      position: absolute;
      border-radius: 50%;
      transform: translateX(-100px);
    }

    &:after{
      content: "";
      width: 200px;
      height: 200px;
      background: red;
      position: absolute;
      border-radius: 50%;
      transform: translateY(-100px);
    }

    p {
      font-size: 2em;
      color: blue;
      position: absolute;
      top: 30px;
      left: 2px;
      transform: rotate(-45deg);
      animation-name: words;
      animation-duration: 2s;
      animation-delay: 3s;
      z-index: 1;
      opacity: 0;
      animation-fill-mode: forwards;
    }

    @keyframes heart{
      25% {
        transform: rotate(45deg) scale(1)
      }

      50% {
        transform: rotate(45deg) scale(0.5)
      }

      75% {
        transform: rotate(45deg) scale(1)
      }

      85% {
        transform: rotate(45deg) scale(0.5)
      }

      100% {
        transform: rotate(45deg) scale(1);
      }
    }

    @keyframes words{
      100% {
        transform: rotate(315deg);
        opacity: 0.8;
      }
    }
  }

  button {
    position: relative;
    left: 50%;
    width: 100px;
    margin-left: -50px;
    padding: 10px 20px;
    color: #fff;
    background-color: #f0397e;
    text-align: center;
  }
}
</style>

<script>
import { MessageBox } from 'mint-ui'

let SetInterval

export default {

  data () {
    return {
      i: 0,
      messages: [
        // 'æˆ‘æœ‰äº›è¯æƒ³å¯¹ä½ è¯´ï¼š',
        // 'ä»ŽçŽ°åœ¨å¼€å§‹ï¼Œæˆ‘åªç–¼ä½ ä¸€ä¸ªï¼Œå® ä½ ï¼Œä¸ä¼šéª—ä½ ï¼Œ',
        // 'ç­”åº”ä½ çš„æ¯ä¸€ä»¶äº‹æƒ…ï¼Œæˆ‘éƒ½ä¼šåšå¾—åˆ°ï¼Œ',
        // 'å¯¹ä½ è®²çš„æ¯ä¸€å¥è¯ï¼Œéƒ½æ˜¯çœŸè¯ï¼Œ',
        // 'ä¸æ¬ºè´Ÿä½ ï¼Œä¸éª‚ä½ ï¼Œç›¸ä¿¡ä½ ï¼Œ',
        // 'æœ‰äººæ¬ºè´Ÿä½ ï¼Œæˆ‘ä¼šåœ¨ç¬¬ä¸€æ—¶é—´æ¥å¸®ä½ ï¼Œ',
        // 'ä½ å¼€å¿ƒçš„æ—¶å€™ï¼Œæˆ‘ä¼šé™ªç€ä½ å¼€å¿ƒï¼Œ',
        // 'ä½ ä¸å¼€å¿ƒï¼Œæˆ‘ä¹Ÿä¼šå“„ç€ä½ å¼€å¿ƒï¼Œ',
        // 'æ°¸è¿œè§‰å¾—ä½ æœ€æ¼‚äº®ï¼Œåšæ¢¦éƒ½ä¼šæ¢¦è§ä½ ï¼Œ',
        // 'åœ¨æˆ‘çš„å¿ƒé‡Œï¼Œåªæœ‰ä½ ï¼',
        // 'å·¥èµ„å¥–é‡‘å…¨äº¤ï¼Œ',
        // 'å‰©èœå‰©é¥­å…¨åŒ…ï¼Œ',
        // 'å®¶åŠ¡æ‚æ´»å…¨å¹²ï¼Œ',
        // 'ä¸€åˆ‡ä»¥è€å©†çš„è¯ä¸ºæœ€é«˜å®—æ—¨ï¼Œéµå¾ª2æ¡åŽŸåˆ™ï¼š',
        // 'ç¬¬ä¸€ï¼Œè€å©†çš„è¯éƒ½æ˜¯å¯¹çš„ï¼›',
        // 'ç¬¬äºŒï¼Œå³ä½¿è€å©†é”™äº†ï¼ŒæŒ‰ç…§ç¬¬ä¸€æ¡æ‰§è¡Œã€‚',
        // 'æˆ‘çˆ±ä½ ï¼'
        'æ¸©æŸ”çš„å¥³äººæ˜¯é‡‘å­ï¼Œ',
        'æ¼‚äº®çš„å¥³äººæ˜¯é’»çŸ³ï¼Œ',
        'èªæ˜Žçš„å¥³äººæ˜¯å®è—ï¼Œ',
        'å¯çˆ±çš„å¥³äººæ˜¯åç”»ï¼',
        'æ®è€ƒè¯ï¼Œ',
        'ä½ æ˜¯ä¸–ç•Œä¸Šæœ€å¤§çš„å®è—ï¼Œ',
        'é‡Œé¢è—æ»¡äº†é‡‘å­ã€é’»çŸ³å’Œåç”»ï¼',
        'ä½ æ²‰é±¼è½é›',
        'ä½ é—­æœˆç¾žèŠ±',
        'ä½ è›¾çœ‰çš“é½¿',
        'ä½ çš“é½¿æ˜Žçœ¸',
        'ä½ ç»è‰²ä½³äºº',
        'ä½ å…°è´¨è•™å¿ƒ',
        'ä½ å¤©ç”Ÿä¸½è´¨',
        'ä½ å›½è‰²å¤©é¦™',
        'ä½ æœ€å¯çˆ±',
        'ä½ æœ€æ¼‚äº®',
      ],
    }
  },
  methods: {
    createRose () {
      var c = document.getElementsByTagName('canvas')[0]
      var a = c.getContext('2d')

      var m = Math

      var C = m.cos
      var S = m.sin
      var P = m.pow
      var R = m.random

      var width = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth
      var height = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight

      width = Math.min(width, 400)
      height = Math.min(height, 400)

      c.width = width
      c.height = height

      var f = width
      var h = -250

      function p (a, b, c) {
        if (c > 60) {
          return [S(a * 7) * (13 + 5 / (0.2 + P(b * 4, 4))) - S(b) * 50, b * f + 50, 625 + C(a * 7) * (13 + 5 / (
            0.2 + P(b * 4, 4))) + b * 400, a * 1 - b / 2, a]
        }
        var A = a * 2 - 1
        var B = b * 2 - 1
        if (A * A + B * B < 1) {
          if (c > 37) {
            var j = c & 1
            var n = j ? 6 : 4
            var o = 0.5 / (a + 0.01) + C(b * 125) * 3 - a * 300
            var w = b * h
            return [o * C(n) + w * S(n) + j * 610 - 390, o * S(n) - w * C(n) + 550 - j * 350, 1180 + C(B + A) * 99 - j * 300, 0.4 - a * 0.1 + P(1 - B * B, -h * 6) * 0.15 - a * b * 0.4 + C(a + b) / 5 + P(C((o * (a + 1) + (B >
              0 ? w : -w)) / 25), 30) * 0.1 * (1 - B * B), o / 1e3 + 0.7 - o * w * 3e-6]
          }
          if (c > 32) {
            c = c * 1.16 - 0.15
            o = a * 45 - 20
            w = b * b * h
            var z = o * S(c) + w * C(c) + 620
            return [o * C(c) - w * S(c), 28 + C(B * 0.5) * 99 - b * b * b * 60 - z / 2 - h, z, (b * b * 0.3 + P((1 - (A * A)), 7) * 0.15 + 0.3) * b, b * 0.7]
          }
          o = A * (2 - b) * (80 - c * 2)
          w = 99 - C(A) * 120 - C(b) * (-h - c * 4.9) + C(P(1 - b, 7)) * 50 + c * 2
          z = o * S(c) + w * C(c) + 700
          return [o * C(c) - w * S(c), B * 99 - C(P(b, 7)) * 50 - c / 3 - z / 1.35 + 450, z, (1 - b / 1.2) * 0.9 + a * 0.1, P((1 - b), 20) / 4 + 0.05]
        }
      }

      if (SetInterval) {
        clearInterval(SetInterval)
      }

      SetInterval = setInterval(() => {
        for (var i = 0; i < 1e4; i++) {
          var s = p(R(), R(), i % 46 / 0.74)
          if (s) {
            var z = s[2]
            var x = ~~(s[0] * f / z - h - width / 6)
            var y = ~~(s[1] * f / z - h - height / 6)
            var q = y * f + x
            if (!m[q] | m[q] > z) {
              /* eslint-disable */
              m[q] = z

              a.fillStyle = 'rgb(' + ~(s[3] * h) + ',' + ~(s[4] * h) +
                ',' + ~(s[3] * s[3] * -80) + ')'

              a.fillRect(x, y, 1, 1)
            }
          }
        }
      }, 0)
    },
    messageBox () {
      MessageBox({
        message: this.messages[this.i],
        closeOnClickModal: false,
      }).then(res => {
        if (this.i !== this.messages.length - 1) {
          this.i ++

          this.messageBox()
        } else {
          this.i = 0
        }
      })
    },
  },
  mounted () {
    this.createRose()
  },

}
</script>
